[train] host=lfs-dev date=2026-02-11T01:02:00+08:00
[train] cuda=NVIDIA GeForce RTX 5090, 32607 MiB;
[train] args: --run-name ts_ablate_silu_lr1e3_5k --out-dir artifacts/experiments/lm --train-data artifacts/tokenized/tinystories_train.bin --valid-data artifacts/tokenized/tinystories_valid.bin --vocab-size 10000 --context-length 256 --d-model 512 --num-layers 4 --num-heads 16 --d-ff 1344 --batch-size 64 --max-iters 5000 --eval-interval 250 --eval-batches 20 --log-interval 50 --save-interval 500 --learning-rate 1e-3 --min-learning-rate 1e-4 --warmup-iters 200 --ffn-type silu --device cuda --dtype bfloat16 --tokenizer-vocab artifacts/bpe/tinystories/vocab.jsonl --tokenizer-merges artifacts/bpe/tinystories/merges.jsonl --generate-prompt Once upon a time --max-new-tokens 256 --top-k 50
[iter 000000] loss=9.2453 lr=0.00e+00 tokens_seen=16384 elapsed=0.5s
[eval 000000] train_loss=9.2515 val_loss=9.2518 best_val=inf
[iter 000050] loss=5.7208 lr=2.50e-04 tokens_seen=835584 elapsed=3.3s
[iter 000100] loss=3.9804 lr=5.00e-04 tokens_seen=1654784 elapsed=5.6s
[iter 000150] loss=3.3360 lr=7.50e-04 tokens_seen=2473984 elapsed=7.8s
[iter 000200] loss=3.0467 lr=1.00e-03 tokens_seen=3293184 elapsed=10.0s
[iter 000250] loss=2.9126 lr=1.00e-03 tokens_seen=4112384 elapsed=12.2s
[eval 000250] train_loss=2.8476 val_loss=2.8454 best_val=9.2518
[iter 000300] loss=2.7474 lr=9.99e-04 tokens_seen=4931584 elapsed=15.2s
[iter 000350] loss=2.5967 lr=9.98e-04 tokens_seen=5750784 elapsed=17.4s
[iter 000400] loss=2.5951 lr=9.96e-04 tokens_seen=6569984 elapsed=19.7s
[iter 000450] loss=2.4743 lr=9.94e-04 tokens_seen=7389184 elapsed=21.9s
[iter 000500] loss=2.4560 lr=9.91e-04 tokens_seen=8208384 elapsed=24.1s
[eval 000500] train_loss=2.3974 val_loss=2.4293 best_val=2.8454
[iter 000550] loss=2.3524 lr=9.88e-04 tokens_seen=9027584 elapsed=27.3s
[iter 000600] loss=2.3367 lr=9.85e-04 tokens_seen=9846784 elapsed=29.5s
[iter 000650] loss=2.3475 lr=9.81e-04 tokens_seen=10665984 elapsed=31.7s
[iter 000700] loss=2.2532 lr=9.76e-04 tokens_seen=11485184 elapsed=34.0s
[iter 000750] loss=2.1473 lr=9.71e-04 tokens_seen=12304384 elapsed=36.2s
[eval 000750] train_loss=2.1959 val_loss=2.2206 best_val=2.4293
[iter 000800] loss=2.1975 lr=9.66e-04 tokens_seen=13123584 elapsed=39.1s
[iter 000850] loss=2.1293 lr=9.60e-04 tokens_seen=13942784 elapsed=41.3s
[iter 000900] loss=2.1530 lr=9.54e-04 tokens_seen=14761984 elapsed=43.6s
[iter 000950] loss=2.1917 lr=9.47e-04 tokens_seen=15581184 elapsed=45.8s
[iter 001000] loss=2.2523 lr=9.40e-04 tokens_seen=16400384 elapsed=48.0s
[eval 001000] train_loss=2.0486 val_loss=2.0885 best_val=2.2206
[iter 001050] loss=2.0642 lr=9.32e-04 tokens_seen=17219584 elapsed=51.2s
[iter 001100] loss=2.0748 lr=9.24e-04 tokens_seen=18038784 elapsed=53.5s
[iter 001150] loss=2.0332 lr=9.16e-04 tokens_seen=18857984 elapsed=55.7s
[iter 001200] loss=2.0385 lr=9.07e-04 tokens_seen=19677184 elapsed=57.9s
[iter 001250] loss=1.9412 lr=8.98e-04 tokens_seen=20496384 elapsed=60.2s
[eval 001250] train_loss=1.9889 val_loss=2.0112 best_val=2.0885
[iter 001300] loss=1.9637 lr=8.88e-04 tokens_seen=21315584 elapsed=63.1s
[iter 001350] loss=1.9183 lr=8.78e-04 tokens_seen=22134784 elapsed=65.3s
[iter 001400] loss=1.9198 lr=8.68e-04 tokens_seen=22953984 elapsed=67.6s
[iter 001450] loss=2.0372 lr=8.58e-04 tokens_seen=23773184 elapsed=69.8s
[iter 001500] loss=1.9819 lr=8.47e-04 tokens_seen=24592384 elapsed=72.0s
[eval 001500] train_loss=1.9171 val_loss=1.9360 best_val=2.0112
[iter 001550] loss=2.0262 lr=8.35e-04 tokens_seen=25411584 elapsed=75.3s
[iter 001600] loss=1.9413 lr=8.24e-04 tokens_seen=26230784 elapsed=77.5s
[iter 001650] loss=1.9542 lr=8.12e-04 tokens_seen=27049984 elapsed=79.7s
[iter 001700] loss=1.9646 lr=8.00e-04 tokens_seen=27869184 elapsed=82.0s
[iter 001750] loss=1.7968 lr=7.88e-04 tokens_seen=28688384 elapsed=84.2s
[eval 001750] train_loss=1.8872 val_loss=1.8765 best_val=1.9360
[iter 001800] loss=1.9037 lr=7.75e-04 tokens_seen=29507584 elapsed=87.1s
[iter 001850] loss=1.8451 lr=7.62e-04 tokens_seen=30326784 elapsed=89.4s
[iter 001900] loss=1.7887 lr=7.49e-04 tokens_seen=31145984 elapsed=91.6s
[iter 001950] loss=1.8554 lr=7.36e-04 tokens_seen=31965184 elapsed=93.8s
[iter 002000] loss=1.8682 lr=7.22e-04 tokens_seen=32784384 elapsed=96.1s
[eval 002000] train_loss=1.8476 val_loss=1.8609 best_val=1.8765
[iter 002050] loss=1.8624 lr=7.09e-04 tokens_seen=33603584 elapsed=99.3s
[iter 002100] loss=1.8769 lr=6.95e-04 tokens_seen=34422784 elapsed=101.6s
[iter 002150] loss=1.8076 lr=6.81e-04 tokens_seen=35241984 elapsed=103.8s
[iter 002200] loss=1.8762 lr=6.66e-04 tokens_seen=36061184 elapsed=106.0s
[iter 002250] loss=1.8545 lr=6.52e-04 tokens_seen=36880384 elapsed=108.3s
[eval 002250] train_loss=1.7987 val_loss=1.8333 best_val=1.8609
[iter 002300] loss=1.8386 lr=6.38e-04 tokens_seen=37699584 elapsed=111.2s
[iter 002350] loss=1.8360 lr=6.23e-04 tokens_seen=38518784 elapsed=113.4s
[iter 002400] loss=1.7865 lr=6.09e-04 tokens_seen=39337984 elapsed=115.7s
[iter 002450] loss=1.8302 lr=5.94e-04 tokens_seen=40157184 elapsed=117.9s
[iter 002500] loss=1.9207 lr=5.79e-04 tokens_seen=40976384 elapsed=120.1s
[eval 002500] train_loss=1.8239 val_loss=1.7974 best_val=1.8333
[iter 002550] loss=1.7992 lr=5.65e-04 tokens_seen=41795584 elapsed=123.4s
[iter 002600] loss=1.7494 lr=5.50e-04 tokens_seen=42614784 elapsed=125.6s
[iter 002650] loss=1.7952 lr=5.35e-04 tokens_seen=43433984 elapsed=127.8s
[iter 002700] loss=1.7274 lr=5.21e-04 tokens_seen=44253184 elapsed=130.1s
[iter 002750] loss=1.7457 lr=5.06e-04 tokens_seen=45072384 elapsed=132.3s
[eval 002750] train_loss=1.8271 val_loss=1.7540 best_val=1.7974
[iter 002800] loss=1.7457 lr=4.91e-04 tokens_seen=45891584 elapsed=135.2s
[iter 002850] loss=1.8290 lr=4.77e-04 tokens_seen=46710784 elapsed=137.5s
[iter 002900] loss=1.7582 lr=4.62e-04 tokens_seen=47529984 elapsed=139.7s
[iter 002950] loss=1.7325 lr=4.48e-04 tokens_seen=48349184 elapsed=141.9s
[iter 003000] loss=1.8084 lr=4.34e-04 tokens_seen=49168384 elapsed=144.1s
[eval 003000] train_loss=1.7282 val_loss=1.7334 best_val=1.7540
[iter 003050] loss=1.8048 lr=4.19e-04 tokens_seen=49987584 elapsed=147.4s
[iter 003100] loss=1.8296 lr=4.05e-04 tokens_seen=50806784 elapsed=149.6s
[iter 003150] loss=1.7200 lr=3.91e-04 tokens_seen=51625984 elapsed=151.8s
[iter 003200] loss=1.7304 lr=3.78e-04 tokens_seen=52445184 elapsed=154.0s
[iter 003250] loss=1.7755 lr=3.64e-04 tokens_seen=53264384 elapsed=156.3s
[eval 003250] train_loss=1.7146 val_loss=1.7057 best_val=1.7334
[iter 003300] loss=1.7673 lr=3.51e-04 tokens_seen=54083584 elapsed=159.2s
[iter 003350] loss=1.6553 lr=3.38e-04 tokens_seen=54902784 elapsed=161.4s
[iter 003400] loss=1.7195 lr=3.25e-04 tokens_seen=55721984 elapsed=163.7s
[iter 003450] loss=1.6928 lr=3.12e-04 tokens_seen=56541184 elapsed=165.9s
[iter 003500] loss=1.6352 lr=3.00e-04 tokens_seen=57360384 elapsed=168.1s
[eval 003500] train_loss=1.7220 val_loss=1.6905 best_val=1.7057
[iter 003550] loss=1.7381 lr=2.88e-04 tokens_seen=58179584 elapsed=171.4s
[iter 003600] loss=1.6586 lr=2.76e-04 tokens_seen=58998784 elapsed=173.6s
[iter 003650] loss=1.6280 lr=2.65e-04 tokens_seen=59817984 elapsed=175.8s
[iter 003700] loss=1.6666 lr=2.53e-04 tokens_seen=60637184 elapsed=178.0s
[iter 003750] loss=1.6647 lr=2.42e-04 tokens_seen=61456384 elapsed=180.3s
[eval 003750] train_loss=1.7019 val_loss=1.6952 best_val=1.6905
[iter 003800] loss=1.6881 lr=2.32e-04 tokens_seen=62275584 elapsed=182.9s
[iter 003850] loss=1.8107 lr=2.22e-04 tokens_seen=63094784 elapsed=185.1s
[iter 003900] loss=1.6604 lr=2.12e-04 tokens_seen=63913984 elapsed=187.4s
[iter 003950] loss=1.6395 lr=2.02e-04 tokens_seen=64733184 elapsed=189.6s
[iter 004000] loss=1.7044 lr=1.93e-04 tokens_seen=65552384 elapsed=191.8s
[eval 004000] train_loss=1.6309 val_loss=1.6614 best_val=1.6905
[iter 004050] loss=1.7580 lr=1.84e-04 tokens_seen=66371584 elapsed=195.1s
[iter 004100] loss=1.5486 lr=1.76e-04 tokens_seen=67190784 elapsed=197.3s
[iter 004150] loss=1.6452 lr=1.68e-04 tokens_seen=68009984 elapsed=199.5s
[iter 004200] loss=1.5750 lr=1.60e-04 tokens_seen=68829184 elapsed=201.7s
[iter 004250] loss=1.6064 lr=1.53e-04 tokens_seen=69648384 elapsed=204.0s
[eval 004250] train_loss=1.6454 val_loss=1.6574 best_val=1.6614
[iter 004300] loss=1.6964 lr=1.46e-04 tokens_seen=70467584 elapsed=206.9s
[iter 004350] loss=1.6017 lr=1.40e-04 tokens_seen=71286784 elapsed=209.2s
[iter 004400] loss=1.6039 lr=1.34e-04 tokens_seen=72105984 elapsed=211.4s
[iter 004450] loss=1.6337 lr=1.29e-04 tokens_seen=72925184 elapsed=213.6s
[iter 004500] loss=1.6501 lr=1.24e-04 tokens_seen=73744384 elapsed=215.8s
[eval 004500] train_loss=1.6283 val_loss=1.6565 best_val=1.6574
[iter 004550] loss=1.6020 lr=1.19e-04 tokens_seen=74563584 elapsed=219.0s
[iter 004600] loss=1.6574 lr=1.15e-04 tokens_seen=75382784 elapsed=221.2s
[iter 004650] loss=1.6081 lr=1.12e-04 tokens_seen=76201984 elapsed=223.5s
[iter 004700] loss=1.6703 lr=1.09e-04 tokens_seen=77021184 elapsed=225.7s
[iter 004750] loss=1.5996 lr=1.06e-04 tokens_seen=77840384 elapsed=227.9s
[eval 004750] train_loss=1.6715 val_loss=1.6110 best_val=1.6565
[iter 004800] loss=1.6462 lr=1.04e-04 tokens_seen=78659584 elapsed=230.9s
[iter 004850] loss=1.6606 lr=1.02e-04 tokens_seen=79478784 elapsed=233.1s
[iter 004900] loss=1.6361 lr=1.01e-04 tokens_seen=80297984 elapsed=235.3s
[iter 004950] loss=1.7166 lr=1.00e-04 tokens_seen=81117184 elapsed=237.5s
[eval 004999] train_loss=1.6263 val_loss=1.6300 best_val=1.6110
Training summary: {"run_name": "ts_ablate_silu_lr1e3_5k", "best_val_loss": 1.6109637320041656, "max_iters": 5000, "tokens_seen": 81920000, "elapsed_sec": 240.47278613701928}
Saved generated text to artifacts/experiments/lm/ts_ablate_silu_lr1e3_5k/generated.txt
