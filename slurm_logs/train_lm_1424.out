[train] host=lfs-dev date=2026-02-11T00:49:19+08:00
[train] cuda=NVIDIA GeForce RTX 5090, 32607 MiB;
[train] args: --run-name ts_lr_1e2_div --out-dir artifacts/experiments/lm --train-data artifacts/tokenized/tinystories_train.bin --valid-data artifacts/tokenized/tinystories_valid.bin --vocab-size 10000 --context-length 256 --d-model 512 --num-layers 4 --num-heads 16 --d-ff 1344 --batch-size 64 --max-iters 1000 --eval-interval 50 --eval-batches 20 --log-interval 10 --save-interval 100 --learning-rate 1e-2 --min-learning-rate 1e-3 --warmup-iters 50 --device cuda --dtype bfloat16 --tokenizer-vocab artifacts/bpe/tinystories/vocab.jsonl --tokenizer-merges artifacts/bpe/tinystories/merges.jsonl --generate-prompt Once upon a time --max-new-tokens 256 --top-k 50
[iter 000000] loss=9.2672 lr=0.00e+00 tokens_seen=16384 elapsed=0.5s
[eval 000000] train_loss=9.2696 val_loss=9.2687 best_val=inf
[iter 000010] loss=5.5411 lr=2.00e-03 tokens_seen=180224 elapsed=1.6s
[iter 000020] loss=4.8175 lr=4.00e-03 tokens_seen=344064 elapsed=2.1s
[iter 000030] loss=4.4186 lr=6.00e-03 tokens_seen=507904 elapsed=2.6s
[iter 000040] loss=3.9884 lr=8.00e-03 tokens_seen=671744 elapsed=3.0s
[iter 000050] loss=3.9292 lr=1.00e-02 tokens_seen=835584 elapsed=3.5s
[eval 000050] train_loss=3.9545 val_loss=3.9086 best_val=9.2687
[iter 000060] loss=3.7856 lr=1.00e-02 tokens_seen=999424 elapsed=4.7s
[iter 000070] loss=3.7213 lr=9.99e-03 tokens_seen=1163264 elapsed=5.2s
[iter 000080] loss=3.5612 lr=9.98e-03 tokens_seen=1327104 elapsed=5.6s
[iter 000090] loss=3.4185 lr=9.96e-03 tokens_seen=1490944 elapsed=6.1s
[iter 000100] loss=3.3845 lr=9.94e-03 tokens_seen=1654784 elapsed=6.6s
[eval 000100] train_loss=3.3759 val_loss=3.3968 best_val=3.9086
[iter 000110] loss=3.4326 lr=9.91e-03 tokens_seen=1818624 elapsed=8.0s
[iter 000120] loss=3.3963 lr=9.88e-03 tokens_seen=1982464 elapsed=8.4s
[iter 000130] loss=3.2946 lr=9.84e-03 tokens_seen=2146304 elapsed=8.9s
[iter 000140] loss=3.2952 lr=9.80e-03 tokens_seen=2310144 elapsed=9.4s
[iter 000150] loss=3.3375 lr=9.76e-03 tokens_seen=2473984 elapsed=9.8s
[eval 000150] train_loss=3.2352 val_loss=3.2389 best_val=3.3968
[iter 000160] loss=3.1882 lr=9.71e-03 tokens_seen=2637824 elapsed=11.0s
[iter 000170] loss=3.1329 lr=9.65e-03 tokens_seen=2801664 elapsed=11.5s
[iter 000180] loss=3.0927 lr=9.59e-03 tokens_seen=2965504 elapsed=12.0s
[iter 000190] loss=3.1724 lr=9.53e-03 tokens_seen=3129344 elapsed=12.4s
[iter 000200] loss=3.2109 lr=9.46e-03 tokens_seen=3293184 elapsed=12.9s
[eval 000200] train_loss=3.1657 val_loss=3.1733 best_val=3.2389
[iter 000210] loss=3.2337 lr=9.38e-03 tokens_seen=3457024 elapsed=14.3s
[iter 000220] loss=3.1031 lr=9.31e-03 tokens_seen=3620864 elapsed=14.8s
[iter 000230] loss=3.1390 lr=9.23e-03 tokens_seen=3784704 elapsed=15.3s
[iter 000240] loss=3.1010 lr=9.14e-03 tokens_seen=3948544 elapsed=15.7s
[iter 000250] loss=3.0373 lr=9.05e-03 tokens_seen=4112384 elapsed=16.2s
[eval 000250] train_loss=3.1074 val_loss=3.1053 best_val=3.1733
[iter 000260] loss=3.0664 lr=8.96e-03 tokens_seen=4276224 elapsed=17.4s
[iter 000270] loss=3.0063 lr=8.86e-03 tokens_seen=4440064 elapsed=17.9s
[iter 000280] loss=3.0493 lr=8.76e-03 tokens_seen=4603904 elapsed=18.3s
[iter 000290] loss=3.0432 lr=8.66e-03 tokens_seen=4767744 elapsed=18.8s
[iter 000300] loss=2.9671 lr=8.55e-03 tokens_seen=4931584 elapsed=19.3s
[eval 000300] train_loss=3.0517 val_loss=3.0514 best_val=3.1053
[iter 000310] loss=3.0420 lr=8.44e-03 tokens_seen=5095424 elapsed=20.7s
[iter 000320] loss=3.0031 lr=8.32e-03 tokens_seen=5259264 elapsed=21.2s
[iter 000330] loss=3.0682 lr=8.20e-03 tokens_seen=5423104 elapsed=21.7s
[iter 000340] loss=3.0255 lr=8.08e-03 tokens_seen=5586944 elapsed=22.1s
[iter 000350] loss=3.0376 lr=7.96e-03 tokens_seen=5750784 elapsed=22.6s
[eval 000350] train_loss=2.9934 val_loss=2.9855 best_val=3.0514
[iter 000360] loss=2.9232 lr=7.84e-03 tokens_seen=5914624 elapsed=23.8s
[iter 000370] loss=2.9056 lr=7.71e-03 tokens_seen=6078464 elapsed=24.3s
[iter 000380] loss=2.9130 lr=7.58e-03 tokens_seen=6242304 elapsed=24.7s
[iter 000390] loss=2.9510 lr=7.44e-03 tokens_seen=6406144 elapsed=25.2s
[iter 000400] loss=2.9929 lr=7.31e-03 tokens_seen=6569984 elapsed=25.7s
[eval 000400] train_loss=2.9311 val_loss=2.9402 best_val=2.9855
[iter 000410] loss=2.9831 lr=7.17e-03 tokens_seen=6733824 elapsed=27.1s
[iter 000420] loss=2.9502 lr=7.03e-03 tokens_seen=6897664 elapsed=27.6s
[iter 000430] loss=2.8452 lr=6.89e-03 tokens_seen=7061504 elapsed=28.1s
[iter 000440] loss=3.0323 lr=6.75e-03 tokens_seen=7225344 elapsed=28.5s
[iter 000450] loss=2.9511 lr=6.60e-03 tokens_seen=7389184 elapsed=29.0s
[eval 000450] train_loss=2.8795 val_loss=2.8853 best_val=2.9402
[iter 000460] loss=2.9027 lr=6.46e-03 tokens_seen=7553024 elapsed=30.2s
[iter 000470] loss=2.9243 lr=6.31e-03 tokens_seen=7716864 elapsed=30.7s
[iter 000480] loss=2.8756 lr=6.17e-03 tokens_seen=7880704 elapsed=31.1s
[iter 000490] loss=2.8209 lr=6.02e-03 tokens_seen=8044544 elapsed=31.6s
[iter 000500] loss=2.8643 lr=5.87e-03 tokens_seen=8208384 elapsed=32.1s
[eval 000500] train_loss=2.8537 val_loss=2.8340 best_val=2.8853
[iter 000510] loss=2.8592 lr=5.72e-03 tokens_seen=8372224 elapsed=33.5s
[iter 000520] loss=2.9148 lr=5.57e-03 tokens_seen=8536064 elapsed=34.0s
[iter 000530] loss=2.7365 lr=5.43e-03 tokens_seen=8699904 elapsed=34.4s
[iter 000540] loss=2.7328 lr=5.28e-03 tokens_seen=8863744 elapsed=34.9s
[iter 000550] loss=2.8855 lr=5.13e-03 tokens_seen=9027584 elapsed=35.4s
[eval 000550] train_loss=2.8217 val_loss=2.8005 best_val=2.8340
[iter 000560] loss=2.8329 lr=4.98e-03 tokens_seen=9191424 elapsed=36.6s
[iter 000570] loss=2.8188 lr=4.83e-03 tokens_seen=9355264 elapsed=37.0s
[iter 000580] loss=2.7245 lr=4.69e-03 tokens_seen=9519104 elapsed=37.5s
[iter 000590] loss=2.7926 lr=4.54e-03 tokens_seen=9682944 elapsed=38.0s
[iter 000600] loss=2.7500 lr=4.40e-03 tokens_seen=9846784 elapsed=38.4s
[eval 000600] train_loss=2.7814 val_loss=2.7703 best_val=2.8005
[iter 000610] loss=2.7597 lr=4.25e-03 tokens_seen=10010624 elapsed=39.9s
[iter 000620] loss=2.6889 lr=4.11e-03 tokens_seen=10174464 elapsed=40.3s
[iter 000630] loss=2.7348 lr=3.97e-03 tokens_seen=10338304 elapsed=40.8s
[iter 000640] loss=2.6743 lr=3.83e-03 tokens_seen=10502144 elapsed=41.3s
[iter 000650] loss=2.7118 lr=3.69e-03 tokens_seen=10665984 elapsed=41.7s
[eval 000650] train_loss=2.7079 val_loss=2.7212 best_val=2.7703
[iter 000660] loss=2.6737 lr=3.56e-03 tokens_seen=10829824 elapsed=43.0s
[iter 000670] loss=2.7123 lr=3.42e-03 tokens_seen=10993664 elapsed=43.4s
[iter 000680] loss=2.7533 lr=3.29e-03 tokens_seen=11157504 elapsed=43.9s
[iter 000690] loss=2.7046 lr=3.16e-03 tokens_seen=11321344 elapsed=44.4s
[iter 000700] loss=2.6226 lr=3.04e-03 tokens_seen=11485184 elapsed=44.8s
[eval 000700] train_loss=2.6329 val_loss=2.6883 best_val=2.7212
[iter 000710] loss=2.6766 lr=2.92e-03 tokens_seen=11649024 elapsed=46.3s
[iter 000720] loss=2.6483 lr=2.80e-03 tokens_seen=11812864 elapsed=46.7s
[iter 000730] loss=2.7274 lr=2.68e-03 tokens_seen=11976704 elapsed=47.2s
[iter 000740] loss=2.6084 lr=2.56e-03 tokens_seen=12140544 elapsed=47.7s
[iter 000750] loss=2.6140 lr=2.45e-03 tokens_seen=12304384 elapsed=48.2s
[eval 000750] train_loss=2.6367 val_loss=2.6293 best_val=2.6883
[iter 000760] loss=2.6097 lr=2.34e-03 tokens_seen=12468224 elapsed=49.3s
[iter 000770] loss=2.6529 lr=2.24e-03 tokens_seen=12632064 elapsed=49.8s
[iter 000780] loss=2.6907 lr=2.14e-03 tokens_seen=12795904 elapsed=50.3s
[iter 000790] loss=2.5655 lr=2.04e-03 tokens_seen=12959744 elapsed=50.7s
[iter 000800] loss=2.5776 lr=1.95e-03 tokens_seen=13123584 elapsed=51.2s
[eval 000800] train_loss=2.6207 val_loss=2.5980 best_val=2.6293
[iter 000810] loss=2.6168 lr=1.86e-03 tokens_seen=13287424 elapsed=52.7s
[iter 000820] loss=2.5671 lr=1.77e-03 tokens_seen=13451264 elapsed=53.1s
[iter 000830] loss=2.6333 lr=1.69e-03 tokens_seen=13615104 elapsed=53.6s
[iter 000840] loss=2.6433 lr=1.62e-03 tokens_seen=13778944 elapsed=54.1s
[iter 000850] loss=2.6562 lr=1.54e-03 tokens_seen=13942784 elapsed=54.6s
[eval 000850] train_loss=2.5772 val_loss=2.5790 best_val=2.5980
[iter 000860] loss=2.5185 lr=1.47e-03 tokens_seen=14106624 elapsed=55.7s
[iter 000870] loss=2.5607 lr=1.41e-03 tokens_seen=14270464 elapsed=56.2s
[iter 000880] loss=2.6352 lr=1.35e-03 tokens_seen=14434304 elapsed=56.7s
[iter 000890] loss=2.4924 lr=1.29e-03 tokens_seen=14598144 elapsed=57.1s
[iter 000900] loss=2.5076 lr=1.24e-03 tokens_seen=14761984 elapsed=57.6s
[eval 000900] train_loss=2.5970 val_loss=2.5614 best_val=2.5790
[iter 000910] loss=2.5402 lr=1.20e-03 tokens_seen=14925824 elapsed=59.1s
[iter 000920] loss=2.5964 lr=1.16e-03 tokens_seen=15089664 elapsed=59.6s
[iter 000930] loss=2.5120 lr=1.12e-03 tokens_seen=15253504 elapsed=60.1s
[iter 000940] loss=2.5653 lr=1.09e-03 tokens_seen=15417344 elapsed=60.5s
[iter 000950] loss=2.5036 lr=1.06e-03 tokens_seen=15581184 elapsed=61.0s
[eval 000950] train_loss=2.5885 val_loss=2.5526 best_val=2.5614
[iter 000960] loss=2.6122 lr=1.04e-03 tokens_seen=15745024 elapsed=62.2s
[iter 000970] loss=2.5151 lr=1.02e-03 tokens_seen=15908864 elapsed=62.7s
[iter 000980] loss=2.5835 lr=1.01e-03 tokens_seen=16072704 elapsed=63.1s
[iter 000990] loss=2.5179 lr=1.00e-03 tokens_seen=16236544 elapsed=63.6s
[eval 000999] train_loss=2.5445 val_loss=2.5253 best_val=2.5526
Training summary: {"run_name": "ts_lr_1e2_div", "best_val_loss": 2.525256633758545, "max_iters": 1000, "tokens_seen": 16384000, "elapsed_sec": 65.04800079006236}
Saved generated text to artifacts/experiments/lm/ts_lr_1e2_div/generated.txt
